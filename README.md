# GameInsight Agent: 游戏评论深度分析与洞察引擎

## 1. 项目简介

GameInsight Agent 是一个基于大型语言模型（LLM）的自动化游戏评论分析工具。它能从原始评论数据中批量提取深层信息，如玩家的核心诉求、情感倾向、游戏设计的优缺点，并将其结构化，最终生成多格式的分析报告（JSON, Excel），为游戏开发者、发行商和市场分析师提供强大、高效的数据洞察支持。

项目旨在解决传统评论分析耗时耗力、主观性强的问题，通过 AI 实现客观、全面、可复现的分析流程。

## 2. 核心功能

- **自动化评论分析**：利用本地部署的 Ollama 及 LLM（如 Llama 3.2），自动对每一条游戏评论进行多维度分析。
- **丰富内容提取**：基于优化的分析提示词（Prompt），提取包括“一句话总结”、“优缺点分析”、“情感标签”在内的丰富内容。
- **结构化数据输出**：将每条评论的分析结果保存为独立的 `JSON` 文件，易于机器读取和后续处理。
- **一键导出 Excel**：自动将分析结果聚合，并导出为两种格式的 `Excel` 报表（基础版与详细版），方便人工查阅和数据透视。
- **中断安全保护**：内置信号处理机制，当程序被意外中断（如 `Ctrl+C`）时，能自动保存当前已完成的分析进度，确保数据不丢失。
- **增量导出**：每分析完一条评论，都会立即尝试更新 `Excel` 文件，最大程度保证数据持久化。
- **模块化代码**：项目采用清晰的模块化结构，将数据处理、AI 引擎、文件导出等功能解耦，易于维护和扩展。
- **云端工作流支持**：集成了 E2B (e2b-code-interpreter) 云端沙箱，支持将整个分析流程部署到云端执行。

## 3. 技术栈

- **编程语言**: Python 3
- **AI 模型**: Ollama & Llama 3.2 (或其它兼容模型)
- **核心库**: `ollama`, `pandas`, `openpyxl`
- **云端环境**: E2B Code Interpreter

## 4. 目录结构

```
GameInsight Agent/
├── data/                   # 存放原始评论数据 (如 .txt 文件)
├── save/                   # 存放所有分析产出物
│   ├── json/               # 保存单条分析结果的 JSON 文件
│   └── excel/              # 保存导出的 Excel 分析报告
├── src/                    # 项目源码
│   ├── __init__.py
│   ├── data/
│   │   ├── __init__.py
│   │   └── robust_excel.py # 封装了健壮的 Excel 导出功能
│   ├── engine/
│   │   ├── __init__.py
│   │   └── analysis.py     # AI 分析引擎核心逻辑
│   └── utils/
│       ├── __init__.py
│       └── file_handler.py # 文件读写、路径管理等工具函数
├── main.py                 # 项目主入口，启动分析流程
├── requirements.txt        # Python 依赖列表
└── README.md               # 本文档
```

## 5. 安装与配置

**第一步：克隆或下载项目**

将本项目代码下载到本地。

**第二步：安装 Ollama**

请确保您已根据官方指引在本地安装并运行了 Ollama 服务。

- [Ollama 官方网站](https://ollama.com/)

**第三步：下载语言模型**

通过 Ollama 下载项目所需的语言模型，推荐使用 `llama3` 或 `llama3.2`。

```bash
ollama pull llama3
```

**第四步：创建虚拟环境并安装依赖**

建议使用虚拟环境以隔离项目依赖。

```bash
# 创建虚拟环境 (例如使用 venv)
python -m venv venv

# 激活虚拟环境
# Windows
.\venv\Scripts\activate
# macOS/Linux
source venv/bin/activate

# 安装项目依赖
pip install -r requirements.txt
```

## 6. 使用方法

1.  **准备数据**：将待分析的游戏评论文本文件（每行一条评论）放入 `data/` 目录下。
2.  **修改配置**：打开 `main.py`，根据需要调整 `INPUT_FILE_PATH` 指向您的数据文件。
3.  **运行程序**：确保 Ollama 服务正在后台运行，然后在项目根目录执行：

    ```bash
    python main.py
    ```

4.  **查看结果**：
    -   分析过程会实时显示在控制台。
    -   每条评论的详细分析结果会以 `JSON` 格式保存在 `save/json/` 目录下。
    -   完整的 `Excel` 分析报告会自动生成并实时更新在 `save/excel/` 目录下。

## 7. 未来展望

- [ ] **增加进度条**：为批量分析过程增加可视化的进度条。
- [ ] **断点续跑**：实现更完善的断点续跑功能，自动跳过已分析的评论。
- [ ] **聚合报告**：对所有分析结果进行二次聚合，自动生成包含高频词云、情感分布图的 Markdown 或 PDF 报告。
- [ ] **完善日志**：引入更详细的日志系统，方便追踪和调试问题。
